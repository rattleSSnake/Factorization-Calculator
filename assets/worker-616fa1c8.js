(function(){"use strict";function*$t(t){let e=2n;for(;t>1n;)t%e===0n?(yield e,t/=e):e++}function*jt(t){let e=2n;for(;t%e===0n;)yield e,t/=e;for(e=3n;e*e<=t;)t%e===0n?(yield e,t/=e):e+=2n;t!==1n&&(yield t)}const H=31;function Ut(t){const e=[];for(let o=0;o<t;o++)e.push(0);return e.slice(0)}function ot(t){const e=Math.ceil(t/(4*H))*4;this.data=Ut(e),this.size=t}ot.prototype.nextSetBit=function(t){if((t|0)>=(this.size|0))return-1;const e=this.data;let o=Math.floor(t/H),n=t%H,l=e[o]>>n;for(;l===0;){if(o+=1,o===e.length)return-1;l=e[o],n=0}return l===-1<<H-1?n+=H-1:n+=31-Math.clz32(l&-+l),o*H+n},ot.prototype.toggle=function(t){if((t|0)>=(this.size|0))throw new RangeError;const e=Math.floor(t/H),o=t%H;this.data[e]^=o===H-1?-1<<o:1<<o},ot.prototype.xor=function(t){const e=this.data,o=t.data,n=e.length|0;if(n!==o.length||n%4!==0)throw new RangeError;for(let l=0;l<n;l+=4)e[l+0]^=o[l+0]|0,e[l+1]^=o[l+1]|0,e[l+2]^=o[l+2]|0,e[l+3]^=o[l+3]|0},ot.prototype.clear=function(){for(let t=0;t<this.data.length;t+=1)this.data[t]=0},ot.prototype.toString=function(){return this.data.map(t=>(t>>>0).toString(2).padStart(H,"0").split("").reverse().join("")).join("").slice(0,this.size)};function tt(t,e=!1){const o=new Array(t).fill(null),n=new Array(t).fill(void 0);let l=null,i=1;const s={next:function(m){for(;;){if(i===1)return i=0,{value:l,done:!1};i=1;const E=m[0],I=m[1];let _=null;if(e)_=E;else{_=new ot(t);for(let y=0;y<E.length;y++){const h=E[y],$=t-1-h;_.toggle($)}}for(let y=_.nextSetBit(0);y!==-1&&_!=null;y=_==null?-1:_.nextSetBit(y+1)){const h=o[y];h!=null?(_.xor(h),_.toggle(y)):(n[y]=I,o[y]=_,_=null)}if(_!=null){const y=[];for(let h=_.nextSetBit(0);h!==-1;h=_.nextSetBit(h+1))y.push(n[h]);y.push(I),l=y}else l=null}}};return s[globalThis.Symbol.iterator]=function(){return this},s}function at(t,e){this.rows=new Array(t).fill(null),this.columns=new Array(e).fill(null).map(o=>[])}at.prototype.addRow=function(t,e){function o(l){const i=l.slice(0);i.sort((c,m)=>c-m);let s=-1;for(let c=0;c<i.length;c++)c===0||i[s]!==i[c]?(s+=1,i[s]=i[c]):s-=1;return i.slice(0,s+1)}const n=o(t);this.rows[e]=n;for(let l=0;l<n.length;l++)this.columns[n[l]].push(e)},at.prototype.deleteColumn=function(t){const e=this.columns[t];if(e!=null){for(let o=0;o<e.length;o++){let n=e[o];const l=this.rows[n].indexOf(t);console.assert(l!==-1),this.rows[n].splice(l,1)}this.columns[t]=null}},at.prototype.deleteRow=function(t){const e=this.rows[t];if(e!=null){for(let o=0;o<e.length;o++){const n=e[o];this.columns[n]=this.columns[n].filter(l=>l!=t)}this.rows[t]=null}},at.prototype.reduce=function(t,e){const o=this.rows[t];console.assert(o.length===1);const n=o[0],l=this.columns[n];for(let i=l.length-1;i>=0;i--)if(l[i]!==t){const s=l[i],c=this.rows[s],m=c.indexOf(n);console.assert(m!==-1),c.splice(m,1),l.splice(i,1),e.push({a:s,b:t})}console.assert(l.length===1&&l[0]===t),this.columns[n]=null,this.rows[t]=null};function wt(t){if(t<1024*2)return tt(t);function e(h,$){return h.sort((p,v)=>p-v),h[Math.max(h.length-$,0)]}function o(h,$){const p=h.columns.map(x=>x==null?0:x.length),v=e(p,$);for(let x=0;x<h.columns.length;x++){const S=h.columns[x];S!=null&&S.length>=v&&h.deleteColumn(x)}}function n(h,$){const p=[];for(let v=0;v<h.rows.length;v++){const x=h.rows[v];x!=null&&x.length===1&&p.push(v)}for(let v=0;v<p.length;v++){const x=p[v],S=h.rows[x];S!=null&&S.length===1?(h.reduce(x,s),$[S[0]]=!0):console.assert(S!=null&&S.length===0)}return p.length}const l=[],i=[],s=[];let c=null,m=null,E=-1;function I(){const $=new at(l.length,t);for(let w=0;w<l.length;w++)$.addRow(l[w].filter(X=>X>=2585),w);const p=new Array(t).fill(!1),v=128;let x=-1;do{x=$.columns.reduce((X,K)=>X+(K==null?0:1),0);const w=Math.ceil($.rows.length/v)-n($,p);w>0&&o($,w)}while(x>0);const S=new Array(t).fill(0);let W=0;for(let w=0;w<$.columns.length;w++)p[w]?S[w]=-1:(S[w]=W,W+=1);const B=W,M=[];function A(w){let X=null;M.length>0?(X=M.pop(),X.clear()):X=new ot(B);for(let K=0;K<w.length;K++){const ct=S[w[K]];ct!==-1&&X.toggle(B-1-ct)}return X}c=l.map(w=>null);const O=$.rows.map(w=>w!=null?1/0:-1);for(let w=s.length-1;w>=0;w-=1)O[s[w].a]!==-1?O[s[w].b]===-1&&(O[s[w].b]=w):s[w]=null;const j=function(w,X){return c[w]==null&&(console.assert(O[w]>=X),c[w]=A(l[w])),c[w]};for(let w=0;w<s.length;w++)s[w]!=null&&(j(s[w].a,w).xor(j(s[w].b,w)),O[s[w].b]<=w&&(M.push(c[s[w].b]),c[s[w].b]=null));for(let w=0;w<$.rows.length;w++)$.rows[w]!=null?(console.assert($.rows[w].length===0),c[w]=j(w,1/0)):c[w]=null;m=tt(B,!0),m.next()}let _=!0;const y={next:function($){if(_)return _=!1,{value:null,done:!1};if(m==null){if(l.length<t+32)return l.push($[0]),i.push($[1]),{value:null,done:!1};I()}for(let p=E+1;p<c.length;p++){E=p;const v=c[p];if(v!=null){const x=m.next([v,p]).value;if(x!=null){const S=new Array(l.length).fill(0);for(let B=0;B<x.length;B++){if(S[x[B]]!==0)throw new RangeError;S[x[B]]=1}for(let B=s.length-1;B>=0;B--)s[B]!=null&&S[s[B].a]===1&&(S[s[B].b]=1-S[s[B].b]);const W=[];for(let B=0;B<S.length;B++)S[B]===1&&W.push(i[B]);return{value:W,done:!1}}}}}};return y[globalThis.Symbol.iterator]=function(){return this},y}tt.solve=tt,tt.sparseSolve=wt,wt.solve=tt,wt.sparseSolve=wt;function st(t,e,o){let n=1;for(;e!==0;)e%2===0?(e/=2,t=t*t%o):(e-=1,n=n*t%o);return n}function St(t,e){return console.assert((e-1)%2===0),st(t,(e-1)/2,e)}function Wt(t,e){if(console.assert(e*e<=Number.MAX_SAFE_INTEGER),St(t,e)!==1)return-1;let o=e-1,n=0;for(;o%2===0;)o/=2,n+=1;if(n===1)return st(t,(e+1)/4,e);let l=2;for(;l<=e&&e-1!==St(l,e);)l+=1;let i=st(l,o,e),s=st(t,(o+1)/2,e),c=st(t,o,e),m=n,E=0;for(;(c-1)%e!==0;){E=c*c%e;let I=1;for(;I<=m&&(E-1)%e!==0;)E=E*E%e,I+=1;const _=st(i,1<<m-I-1,e);s=s*_%e,i=_*_%e,c=c*i%e,m=I}return s}function zt(t){function e(r){return JSON.parse(r.trim().replace(/\s*\)/g,"]").replace(/\(\s*/g,"[").replace(/\s+/g,",").replaceAll('"',"").replace(/([^\[\],]+)/g,'"$1"'))}const o=[];function n(r){if((r&127)!==r)throw new RangeError;o.push(r)}function l(r,u){do{const F=u&127|(u>>>7?128:0);u>>>=7,o.splice(r,0,F),r+=1}while(u!==0)}function i(r){const u=o.length;r();const F=o.length;l(u,F-u)}function s(r){n(r.length);for(let u=0;u<r.length;u++)n(r.charCodeAt(u))}function c(r){r<=240?o.push(r):(o.push(r>>8),l(o.length,r&255))}function m(){for(const r of[0,97,115,109])n(r)}function E(){for(const r of[1,0,0,0])n(r)}function I(r,u){console.assert(r[0]===u),i(function(){for(let F=1;F<r.length;F++)n(v(r[F]))})}function _(){n(1),i(function(){n(gt.length);for(const r of gt){const u=r[2];if(u[0]==="func")n(96),I(u[1],"param"),I(u[2],"result");else throw new TypeError}})}function y(){n(2),i(function(){n(rt.length);for(const r of rt)if(console.assert(r.length===4),s(r[1]),s(r[2]),r[3][0]==="memory")n(2),n(0),n(0);else throw new TypeError})}function h(){n(3),i(function(){n(nt.length);for(let r=0;r<nt.length;r++)n(r)})}function $(){n(7),i(function(){n(G.length);for(const r of G)if(console.assert(r.length===3),s(r[1]),r[2][0]==="func"){console.assert(r[2].length===2),n(0);const u=r[2][1],F=nt.findIndex(q=>q[1]===u);n(F)}else throw new TypeError})}const p={i32:127,i64:126,f32:125,f64:124,v128:123};function v(r){const u=p[r];if(u==null)throw new TypeError("unknown type: "+r);return u}const x="unreachable nop block loop if else - - - - - end br br_if br_table return call call_indirect - - - - - - - - drop select - - - - local.get local.set local.tee global.get global.set - - - i32.load i64.load f32.load f64.load i32.load8_s i32.load8_u i32.load16_s i32.load16_u i64.load8_s i64.load8_u i64.load16_s i64.load16_u i64.load32_s i64.load32_u i32.store i64.store f32.store f64.store i32.store8 i32.store16 i64.store8 i64.store16 i64.store32 memory.size memory.grow i32.const i64.const f32.const f64.const i32.eqz i32.eq i32.ne i32.lt_s i32.lt_u i32.gt_s i32.gt_u i32.le_s i32.le_u i32.ge_s i32.ge_u i64.eqz i64.eq i64.ne i64.lt_s i64.lt_u i64.gt_s i64.gt_u i64.le_s i64.le_u i64.ge_s i64.ge_u f32.eq f32.ne f32.lt f32.gt f32.le f32.ge f64.eq f64.ne f64.lt f64.gt f64.le f64.ge i32.clz i32.ctz i32.popcnt i32.add i32.sub i32.mul i32.div_s i32.div_u i32.rem_s i32.rem_u i32.and i32.or i32.xor i32.shl i32.shr_s i32.shr_u i32.rotl i32.rotr i64.clz i64.ctz i64.popcnt i64.add i64.sub i64.mul i64.div_s i64.div_u i64.rem_s i64.rem_u i64.and i64.or i64.xor i64.shl i64.shr_s i64.shr_u i64.rotl i64.rotr f32.abs f32.neg f32.ceil f32.floor f32.trunc f32.nearest f32.sqrt f32.add f32.sub f32.mul f32.div f32.min f32.max f32.copysign f64.abs f64.neg f64.ceil f64.floor f64.trunc f64.nearest f64.sqrt f64.add f64.sub f64.mul f64.div f64.min f64.max f64.copysign i32.wrap_i64 i32.trunc_f32_s i32.trunc_f32_u i32.trunc_f64_s i32.trunc_f64_u i64.extend_i32_s i64.extend_i32_u i64.trunc_f32_s i64.trunc_f32_u i64.trunc_f64_s i64.trunc_f64_u f32.convert_i32_s f32.convert_i32_u f32.convert_i64_s f32.convert_i64_u f32.demote_f64 f64.convert_i32_s f64.convert_i32_u f64.convert_i64_s f64.convert_i64_u f64.promote_f32 i32.reinterpret_f32 i64.reinterpret_f64 f32.reinterpret_i32 f64.reinterpret_i64".split(" "),S={};for(let r=0;r<x.length;r++)S[x[r]]=r;const B=Object.assign({},S,{"i8x16.splat":64783,"i8x16.ge_u":64812,"i8x16.all_true":64867,"i32x4.splat":64785,"i32x4.lt_s":64825,"i32x4.ge_s":64831,"i32x4.gt_s":64827,"i32x4.all_true":64931,"v128.any_true":64851,"i8x16.gt_s":64807,"i8x16.gt_u":64808,"v128.xor":64849,"v128.load":64768,"v128.store":64779});function M(r){const u=B[r];if(u==null)throw new TypeError("unknown instruction: "+r);return u}const A=64,O=[];let j=[];function w(r){if(r.length>3)throw new TypeError;const u=r[1],F=j.indexOf(u);r.length===3&&z(r[2]),n(M(r[0])),n(F)}function X(r){if(r.length!==2)throw new TypeError;//! 0 <= c <= 63
if((Number(r[1])&63).toString()!==r[1])throw new RangeError("unsupported literal: "+r[1]);n(M(r[0])),n(Number(r[1]))}function K(r,u){const F=typeof r[u?2:1]=="string"?r[u?2:1]:null;O.push(F),u&&z(r[1]),n(M(r[0])),n(A);const q=1+(F!=null?1:0)+(u?1:0);if(u){if(r.length>q+2)throw new TypeError;z(r[q]),r.length===q+2&&(n(M("else")),z(r[q+1]))}else for(let N=q;N<r.length;N++)z(r[N]);n(M("end")),O.pop()}function ct(r,u){if(r.length!==2+(u?1:0))throw new TypeError;const F=r[1];u&&z(r[2]),n(M(r[0])),n(O.length-1-O.lastIndexOf(F))}function Z(r){const u=/^[ifv](32|64|128)\.(?:store|load)(8|16|32|64|)(?:_u|_s)?$/.exec(r[0]);if(u==null)throw new TypeError(r[0]);const F=Math.round(Math.log2(Number(u[2]||u[1])/8));let q=0;for(let N=1;N<r.length;N++)if(typeof r[N]=="string"){const Q=/^offset=(\d+)$/.exec(r[N]);if(Q==null)throw new TypeError;q=Number(Q[1])}else z(r[N]);c(M(r[0])),n(F),n(q)}function bt(r){if(r.length<2)throw new TypeError;const u=r[1],F=nt.findIndex(q=>q[1]===u);for(let q=2;q<r.length;q++)z(r[q]);n(M(r[0])),n(F)}function z(r){if(r[0].startsWith("local."))w(r);else if(r[0].endsWith(".const"))X(r);else if(r[0]==="loop"||r[0]==="block"||r[0]==="if")K(r,r[0]==="if");else if(r[0]==="br"||r[0]==="br_if")ct(r,r[0]==="br_if");else if(r[0].indexOf(".store")!==-1||r[0].indexOf(".load")!==-1)Z(r);else if(r[0]==="call")bt(r);else{for(let u=1;u<r.length;u++)z(r[u]);c(M(r[0]))}}function Et(){n(10),i(function(){n(nt.length);for(const r of nt)i(function(){const u=[],F=[],q=[];for(let N=2;N<r.length;N++)r[N][0]==="param"?F.push({name:r[N][1],type:r[N][2]}):r[N][0]==="result"||(r[N][0]==="local"?(console.assert(r[N].length===3),u.push({name:r[N][1],type:r[N][2]})):q.push(r[N]));n(u.length);for(const N of u)n(1),n(v(N.type));j=F.concat(u).map(N=>N.name);for(const N of q)z(N);n(M("end"))})})}const gt=[],rt=[],nt=[],G=[],ut=e(t);if(ut[0]!=="module")throw new TypeError;for(let r=1;r<ut.length;r++){const u=ut[r];if(u[0]==="type")gt.push(u);else if(u[0]==="import")rt.push(u);else if(u[0]==="func")nt.push(u);else if(u[0]==="export")G.push(u);else throw new TypeError}return m(),E(),_(),y(),h(),$(),Et(),new Uint8Array(o)}function Mt(t,e){if(typeof t!="bigint"||typeof e!="bigint")throw new TypeError;if(t<0n||t>=e||e<=0n)throw new RangeError;let o=t,n=e,l=1n,i=0n;for(;n!==0n;){const s=(o-o%n)/n,c=o-s*n;o=n,n=c;const m=l-s*i;l=i,i=m}return o!==1n?0n:l<0n?l+e:l}function It(t,e){if(typeof t!="number"||typeof e!="number")throw new TypeError;const o=~(-1<<30);if(t<0||t>=e||e<=0||e>o)throw new RangeError;let n=t&o,l=e&o,i=1,s=0;for(;l!==0;){const c=Math.floor(n/l),m=n%l;n=l,l=m;const E=i-c*s;i=s,s=E}return n!==1?0:i<0?i+e:i}function Bt(t,e,o,n){if(typeof t!="bigint"||typeof e!="bigint"||typeof o!="bigint"||typeof n!="bigint")throw new TypeError;const l=Mt(o%n,n);return t+(e-t)*l%n*o}function Gt(t,e,o=1){let n=[];n.push(0n);let l=1n;for(let i=0;i<e.length;i+=1){const s=BigInt(Math.pow(e[i],o));if(Number(s)>Number.MAX_SAFE_INTEGER)throw new RangeError;const c=BigInt(mt(Number(t%s),e[i],o)),m=[];for(let E=0;E<n.length;E+=1){const I=n[E];m.push(Bt(I,c,l,s)),m.push(Bt(I,-c,l,s))}l*=s,n=m}return n}function kt(t,e=1){if(e>=3){if(t%8===1){const o=Math.pow(2,e),n=+kt(t,e-1)[0],l=o/4-n,i=n*n%o!==t?l:n;return[i,o/2-i,o/2+i,o-i]}return[]}return e>=2?t%4===1?[1,3]:[]:e>=1?[1]:[]}function mt(t,e,o=1){if(typeof t!="number"||typeof e!="number"||typeof o!="number")throw new TypeError;const n=Math.pow(e,o);if(!(t>0&&t<n&&e>0&&o>=1&&+t%+e!==0&&n<Math.floor(Math.sqrt(Number.MAX_SAFE_INTEGER*4))))throw new RangeError;if(e%2===0)throw new RangeError;if(o>1){const l=mt(t%Math.pow(e,o-1),e,o-1);let i=It(2*l,n)%n,s=(t-l*l)%n;i=i>n/2?i-n:i,s=s>n/2?s-n:s;let c=l+s*i%n;return c>=n&&(c-=n),c<0&&(c+=n),c>n-c&&(c=n-c),c}if((e+1)%4===0){let l=Rt(t,(e+1)/4,e);if(l*l%e===t)return l>e-l&&(l=e-l),l}{const l=Wt(t,e)|0;return Math.min(l,e-l)}}function _t(t){return BigInt(t.toString(16).length*4)}function Tt(t){if(t<BigInt((Number.MAX_SAFE_INTEGER+1)/2))return BigInt(Math.floor(Math.sqrt(Number(BigInt(t))+.5)));const e=_t(t)>>2n;let n=Tt(t>>e*2n)+1n<<e,l=n+1n;for(;n<l;)l=n,n=l+t/l>>1n;return l}function Qt(t,e){let o=BigInt(t);if(o===0n)return[0];const n=[];o<0n&&(n.push(-1),o=-o);let l=0;for(;l<e.length;){const i=e[l];for(;o%BigInt(i)===0n;)o/=BigInt(i),n.push(i);l+=1}return o===1n?n:null}function dt(t,e,o){this.X=t,this.Y=e,this.N=o}dt.prototype.toString=function(){return"X**2 â‰¡ Y (mod N)".replaceAll("X",this.X).replaceAll("N",this.N).replaceAll("Y",this.Y.join(" * "))};function At(t,e){if(typeof t!="bigint"||typeof e!="number")throw new TypeError;if(e===2)return!0;const o=Number(BigInt(t)%BigInt(e));if(o===0)return!0;console.assert(e%2===1);const n=Rt(o,(e-1)/2,e);return console.assert(n===1||n===e-1),n===1}function ht(t){const e=Math.max(Number(_t(t))-48,0);return Math.log(Number(t>>BigInt(e)))+Math.log(2)*e}function Lt(t){const e=ht(t);return Math.exp(Math.sqrt(e*Math.log(e)))}function Rt(t,e,o){if(typeof t!="number"||typeof e!="number"||typeof o!="number")throw new TypeError;if(Math.max(Math.pow(o,2),Math.pow(t,2))>Number.MAX_SAFE_INTEGER)throw new RangeError;let n=1;for(;e!==0;)e%2===0?(e/=2,t=+t*+t%o):(e-=1,n=n*t%o);return n}function Vt(t,e,o){if(typeof t!="bigint"||typeof e!="bigint"||typeof o!="bigint")throw new TypeError;let n=e,l=t,i=1n;for(;n!==0n;)BigInt.asUintN(1,n)===1n&&(n-=1n,i=i*l%o),n>>=1n,l=l*l%o;return i}function Jt(t){const e=new Array(t+1).fill(!0),o=[];o.push(2);for(let n=3;n<=t;n+=2)if(e[n]&&(o.push(n),n<=Math.floor(t/n)))for(let l=n*n;l<=t;l+=2*n)e[l]=!1;return o}//!copy-paste
function Ft(t){const e=[];for(;t!==0n;){const o=Number(BigInt.asUintN(51,t));e.push(o),t>>=51n}return e}function Nt(t,e){const o=t.length-1;let n=t[o];const l=e,i=(1+2**-52)/l;if(n=n-Math.floor(n*i)*l,o>0){const s=0x8000000000000-Math.floor(0x8000000000000*i)*l;let c=o;do c-=1,n=n*s+t[c],n=n-Math.floor(n*i)*l;while(c!==0)}return n}function Ht(t){let e=Math.floor(Math.pow(2,Math.floor(t))*Math.exp(Math.LN2*(t-Math.floor(t))));return e%2===0&&(e+=1),e}function lt(t,e,o,n){if(typeof t!="bigint"||typeof e!="bigint"||typeof o!="bigint")throw new TypeError;const l=e*e-o;if(l%t!==0n)throw new TypeError;const i=l/t;this.A=t,this.B=e,this.C=i,this.AFactors=n;const s=ht(t),c=-Math.exp(ht(e)-s),m=Math.exp(ht(o)/2-s);this.x1=c-m,this.x2=c+m,this.log2a=s/Math.LN2}lt.generator=function(t,e,o){const n=function(p,v){return p.length===0?[]:v===0?[[]]:v===1?p.map(x=>[x]):n(p.slice(1),v-1).map(x=>[p[0]].concat(x)).concat(n(p.slice(1),v))},l=function(p,v){if(typeof p!="bigint")throw new TypeError;const x=_t(p);return Math.round(x<=1023n?Math.pow(Number(p),1/v):Math.pow(Number(p>>x-1023n),1/v)*Math.pow(2,Number(x-1023n)/v))},i=BigInt(Tt(2n*o))/BigInt(t),s=ht(i)/Math.log(2);if(e.length<42)throw new TypeError;const c=Math.log2(e[e.length-1]),m=Math.max(2,Math.ceil(s/Math.min(14.5,c)/2)*2),E=l(i,m);let I=0;const _=function(){let p=0;do p=E-E%2+1+(I%2===0?I:-1-I),I+=1;while(xt(e,p)===-1);return p};let y=[];const h=[],$=[];return et.polynomialsCounter=0,{next:function(){for(;h.length===0;){for(;y.length===0;){const M=_(),A=_();console.assert(m%2===0),y=n($,m/2-1).map(O=>[[M,A]].concat(O)),$.push([M,A])}const v=y.pop().reduce((M,A)=>M.concat(A),[]),x=BigInt(v.reduce((M,A)=>M*BigInt(A),1n));if(Mt(x%o,o)===0n)return this.next();const W=x,B=Gt(o,v,1);for(let M=0;M<B.length;M+=1)B[M]=B[M]<0n?W-B[M]:B[M];B.sort((M,A)=>Number(BigInt(M)-BigInt(A)));for(let M=0;M<B.length/2;M+=1){const A=B[M];h.push(new lt(W,A,o,v))}}return et.polynomialsCounter+=1,h.shift()}}},lt.prototype.X=function(t){return this.A*BigInt(t)+this.B},lt.prototype.Y=function(t,e,o){if(typeof t!="number")throw new TypeError;const n=this.A*(t*t>=2**53?BigInt(t)*BigInt(t):BigInt(t*t))+this.B*BigInt(2*t)+this.C;if(n%e!==0n)return null;const l=Qt(n/e,o);return l==null?null:l.length===1&&l[0]===0?l:this.AFactors.concat(l)},lt.prototype.log2AbsY=function(t){if(typeof t!="number")throw new TypeError;return Math.log2(Math.abs((t-this.x1)*(t-this.x2)))+this.log2a};function qt(t,e,o,n){let l=n>2048?n>262144?1024:256:1;for(;l>=2&&Math.abs(t.log2AbsY(e+l)-o)>.5;)l=Math.floor(l/2);return e+l}function Ct(t){const e=[];for(let o=0;o<t;o+=1)e.push(0);return e.slice(0)}function Kt(t,e,o){var n=new t.Int32Array(o),l=new t.Uint16Array(o),i=new t.Uint8Array(o);function s(m,E,I,_,y){m=m|0,E=E|0,I=I|0,_=_|0,y=y|0;var h=0,$=0,p=0,v=0,x=0,S=0,W=0,B=0;for(h=y,S=m;(S|0)<(E|0);S=S+12|0){for(p=n[S>>2]|0,v=n[S+4>>2]|0,$=l[S+8>>1]|0,h=h+(l[S+10>>1]|0)|0;(v|0)<(I|0);)i[p]=(i[p]|0)+$|0,p=p+h|0,i[v]=(i[v]|0)+$|0,v=v+h|0;(p|0)<(I|0)&&(i[p]=(i[p]|0)+$|0,p=p+h|0,x=p,p=v,v=x),n[S>>2]=p-_|0,n[S+4>>2]=v-_|0}return 0}function c(m,E){for(m=m|0,E=E|0;(m|0)>=(i[E]|0);)E=E+1|0;return E|0}return{singleBlockSieve:s,findSmoothEntry:c}}const Zt=(t=>String.raw({raw:t}))`
(module
 (type $type1 (func (param i32 i32 i32 i32 i32) (result i32)))
 (type $type2 (func (param i32 i32) (result i32)))
 (import "env" "memory" (memory $0 0))
 (export "singleBlockSieve" (func $singleBlockSieve))
 (export "findSmoothEntry" (func $findSmoothEntry))
 (func $singleBlockSieve (param $startWheelData i32) (param $endWheelData i32) (param $subsegmentEnd i32) (param $s i32) (param $p i32) (result i32)
  (local $step i32)
  (local $log2p i32)
  (local $kpplusr i32)
  (local $kpplusr2 i32)
  (local $k i32)
  (local $k2 i32)
  (local $tmp i32)
  (local $wheel i32)
  (local.set $step (local.get $p))
  (local.set $wheel (local.get $startWheelData))
  (loop $wheels
   (if (i32.lt_s (local.get $wheel) (local.get $endWheelData))
    (block
     (local.set $kpplusr (i32.load offset=0 (local.get $wheel)))
     (local.set $kpplusr2 (i32.load offset=4 (local.get $wheel)))
     (local.set $log2p (i32.load16_u offset=8 (local.get $wheel)))
     (local.set $step (i32.add (local.get $step) (i32.load16_u offset=10 (local.get $wheel))))
     (loop $sieving
      (if (i32.lt_s (local.get $kpplusr2) (local.get $subsegmentEnd))
       (block
        (i32.store8 (local.get $kpplusr) (i32.add (i32.load8_u (local.get $kpplusr)) (local.get $log2p)))
        (local.set $kpplusr (i32.add (local.get $kpplusr) (local.get $step)))
        (i32.store8 (local.get $kpplusr2) (i32.add (i32.load8_u (local.get $kpplusr2)) (local.get $log2p)))
        (local.set $kpplusr2 (i32.add (local.get $kpplusr2) (local.get $step)))
        (br $sieving)
       )
      )
     )
     (if (i32.lt_s (local.get $kpplusr) (local.get $subsegmentEnd))
      (block
       (i32.store8 (local.get $kpplusr) (i32.add (i32.load8_u (local.get $kpplusr)) (local.get $log2p)))
       (local.set $kpplusr (i32.add (local.get $kpplusr) (local.get $step)))
       (local.set $tmp (local.get $kpplusr))
       (local.set $kpplusr (local.get $kpplusr2))
       (local.set $kpplusr2 (local.get $tmp))
      )
     )
     (i32.store offset=0 (local.get $wheel) (i32.sub (local.get $kpplusr) (local.get $s)))
     (i32.store offset=4 (local.get $wheel) (i32.sub (local.get $kpplusr2) (local.get $s)))
     (local.set $wheel (i32.add (local.get $wheel) (i32.const 12)))
     (br $wheels)
    )
   )
  )
  (return (i32.const 0))
 )
 (func $findSmoothEntry (param $thresholdApproximation i32) (param $i i32) (result i32)
  (local $t v128)
  (local.set $t (i8x16.splat (local.get $thresholdApproximation)))
  (loop $loop
   (if (i32.eqz (v128.any_true (i8x16.ge_u (v128.load (local.get $i)) (local.get $t))))
    (block
     (local.set $i (i32.add (local.get $i) (i32.const 16)))
     (br $loop)
    )
   )
  )
  (return (local.get $i))
 )
)
`;let vt=null;function te(t){if(vt==null){const i=zt(Zt);vt=new WebAssembly.Module(i)}const e=Math.ceil(t/2**16),o=new WebAssembly.Memory({initial:e,maximum:e}),n=o.buffer,l=new WebAssembly.Instance(vt,{env:{memory:o}}).exports;return Object.assign({},l,{memory:{buffer:n}})}function ee(t){if(globalThis.WebAssembly!=null)try{return te(t)}catch(n){console.error(n)}const e=new ArrayBuffer(t),o=Kt(globalThis,null,e);return Object.assign({},o,{memory:{buffer:e}})}function Dt(t,e,o){if(typeof e!="bigint")throw new TypeError;let n=Number(o||0);n===0&&(n=3*2**14,n=Math.min(n,Math.ceil(Math.pow(+t[t.length-1],1.15))),n=Math.max(n,t[t.length-1]+1));const l=Math.ceil(n/(navigator.hardwareConcurrency===12?2.75*2**20:6*2**20));console.debug("q",l);const i=Math.ceil(Math.ceil(n/l)/48)*48,s=i*l,c=0,m=255,E=2**0,I=Math.log2(t.length===0?Math.sqrt(2):+t[t.length-1]),_=I+Math.min(8.5,I),y=new Map,h=[];for(let d=0;d<t.length;d+=1){const a=+t[d];for(let f=1,k=a;k<=s||f===1;f+=1,k*=a){const b=Number(e%BigInt(k));if(b%a!==0)if(a===2){const R=kt(b,f);for(let g=0;g<Math.ceil(R.length/2);g+=1)h.push({step:k,p:a,root:R[g]|0})}else{const R=mt(b,a,f);h.push({step:k,p:a,root:R|0})}}}h.sort((d,a)=>+d.step-+a.step);const $=Ct(h.length);function p(d){return d=Math.max(d,2**12),d<=2**24?Math.pow(2,Math.ceil(Math.log2(d-.5))):Math.ceil(d/2**24)*2**24}const v=p(i+h.length*3*4),x=ee(v),S=x.singleBlockSieve,W=x.findSmoothEntry,B=x.memory.buffer,M=new Uint8Array(B),A=new Int32Array(B);console.assert(i%4===0);const O=i/4,j=h.length,w=[];let X=0;for(let d=0;d<j;d+=1){const a=h[d],f=O+d*3,k=Math.round(Math.log2(a.p)*(a.step===2?.5:1)*E)|0,b=(a.step|0)-X;if(b>=2**14||k>=2**14)throw new RangeError;X=a.step,A[f]=0,A[f+1]=0,A[f+2]=k|b<<16,$[d]=a.root|0,w.push(Math.log2(a.p)*(a.step===2?.5:1))}const K=function(d,a,f,k){const b=y.get(d);if(b==null)y.set(d,{polynomial:a,x:f,pb:k});else{const R=BigInt(d),g=Mt(R,e);if(g===0n)return new dt(R,[0],e);{const T=a.X(f),Y=a.Y(f,R,k),C=b.polynomial.X(b.x),P=b.polynomial.Y(b.x,R,b.pb),D=g*C*T%e;if(Y!=null&&P!=null){const U=Y.concat(P);return new dt(D,U,e)}}}return null},ct=lt.generator(s/2,t,e);let Z=null,bt=0n;const z=Ct(h.length),Et=function(d,a){a=-0+a;const f=Ft(d.A),k=Ft(d.B),b=BigInt(d.A)===BigInt(bt);let R=-0;for(let g=0;g<j;g+=1){const T=O+((g<<1)+g|0)|0;R=R+ +(A[T+2]>>16);const Y=-0+($[g]|0);if(!b){const U=+Nt(f,R);z[g]=-0+It(U,R)}const C=+z[g],P=(1+2**-52)/R,D=+Nt(k,R);if(C===0)A[T]=s,A[T+1]=s;else{const U=R-D+R;let L=(U+Y)*C-a,V=(U-Y)*C-a;L=L-Math.floor(L*P)*R,V=V-Math.floor(V*P)*R;const J=L|0,ft=V|0,pt=J-ft&J-ft>>31;A[T]=ft+pt,A[T+1]=J-pt}}bt=d.A},gt=function(d,a){for(;a!==0;){const f=+d%+a;d=a,a=f}return d},rt=function(d,a){return Math.floor(d/gt(d,a))*a},G=function(){let d=1,a=0;for(;a<h.length&&rt(d,h[a].step)<=i/5;)d=rt(d,h[a].step),a+=1;return a}(),ut=function(d,a,f){if(typeof f!="number"||typeof a!="number")throw new TypeError;if(f>d.length)throw new RangeError;for(let k=a;k<f;k+=a)d.copyWithin(k,0,Math.min(f-k,a))},r=function(d){if(typeof d!="number")throw new TypeError;let a=1;M[0]=c;let f=0;for(let T=0;T<G;T+=1){const Y=O+((T<<1)+T|0)|0,C=+rt(a,f+(A[Y+2]>>16));ut(M,a,C),a=C,f=f+(A[Y+2]>>16)|0;const P=A[Y+2]&65535;for(let D=((A[Y]|0)+C-d%C)%f;D<C;D+=f)M[D]=M[D]+P|0;for(let D=((A[Y+1]|0)+C-d%C)%f;D<C;D+=f)M[D]=M[D]+P|0}ut(M,a,i);const k=navigator.hardwareConcurrency===12?1:1.5,b=Math.min(0+j-G,Math.floor(64*3*k*(j>2**18?2:1))),R=Math.floor(2**15*k-b*4);let g=0;for(console.assert(O%3===0);g+R<=i;)g+=R,S(G*12+O*4,G*12+b*12+O*4,g,0,f);S(G*12+O*4,j*12+O*4,i,i,f)},u=[],F=[],q=[],N=function(d,a){if(typeof d!="number")throw new TypeError;let f=0,k=0;for(;f<i;){k=Math.round((a.log2AbsY(f+d)-_)*E+c)|0;const b=Math.min(i,qt(a,f+d,(k-c)*(1/E)+_,s)-d);for(;f<b;){if(f<b-1&&b+3<i){const R=M[b-1];for(M[b-1]=m,f=W(k,f);k>=M[f];)f+=1;M[b-1]=R}k<M[f]&&(u.push(f+d),F.push((M[f]-c)*(1/E)),q.push([])),f+=1}}},Q=new Uint8Array((s>>3+3)+1),fe=function(d){if(typeof d!="number")throw new TypeError;const a=[];for(let g=0;g<u.length;g+=1)a.push(-0+(u[g]-d));const f=[];for(let g=0;g<a.length;g+=1)f.push(-0);for(let g=0;g<Q.length;g+=1)Q[g]=0;for(let g=0;g<a.length;g+=1){const T=a[g]>>3;Q[T>>3]|=1<<(T&7)}const k=Math.max(G,Math.min(1024,Math.ceil(j/1)));let b=0;for(let g=0;g<k;g+=1){const T=O+((g<<1)+g|0)|0;let Y=A[T]|0,C=A[T+1]|0;if(b=b+(A[T+2]>>16)|0,Y===0&&C===0&&g>=G)continue;const P=g<G?0:s,D=-0+b,U=(1+2**-52)/D,L=-0+(Y+P)%b,V=-0+(C+P)%b;for(let J=a.length-1;J>=0;J-=1){const ft=a[J],pt=ft-Math.floor(ft*U)*D;pt===L&&(f[J]+=+w[g],q[J].push(b)),pt===V&&(f[J]+=+w[g],q[J].push(b))}}const R=function(g,T,Y){const C=g>>3;if(Q[C>>3]&1<<(C&7)){const P=xt(u,0+g+d);P!==-1&&(f[P]+=+w[T],q[P].push(Y))}};console.assert(h.length>0&&s>=h[h.length-1].step);for(let g=k;g<j;g+=1){const T=O+((g<<1)+g|0)|0,Y=A[T]|0,C=A[T+1]|0;b=b+(A[T+2]>>16)|0;let P=Y+(s-b|0)|0,D=C+(s-b|0)|0,U=0;do U=U|Q[D>>6]|Q[P>>6],P=P-b|0,D=D-b|0;while(P>=0);if(D=D+(D>>31&b)|0,U=U|Q[D>>6],U&&(Y!==0||C!==0)){let L=Y+s-b,V=C+s-b;for(;L>=0;)Q[L>>6]&&R(L,g,b),L=L-b|0;for(;V>=0;)Q[V>>6]&&R(V,g,b),V=V-b|0}}for(let g=0;g<F.length;g+=1){const T=Math.abs(F[g]-f[g]);T>=9&&T<100&&console.error(T),F[g]=f[g]}};et.lpCounter=0;let it=-1,Pt=0;const Xt={next:function(){for(;2*Pt*s<=Math.pow(t[t.length-1],2);){it===s&&(Pt+=1,it=-1);const a=-s/2;if(it===-1){Z=ct.next(),Et(Z,a),u.length=0,F.length=0,q.length=0;for(let f=0;f<s;f+=i)r(f),N(a+f,Z);fe(a)}for(let f=it+1;f<u.length;f+=1){const k=u[f],b=+F[f],R=+Z.log2AbsY(k);if(R-b<1){const g=Z.X(k),T=Z.Y(k,1n,q[f]);if(T!=null)return it=f,{value:new dt(g,T,e),done:!1};console.count("?")}else if(R-b<_){const g=Ht(R-b),T=K(g,Z,k,q[f]);if(T!=null)return it=f,et.lpCounter+=1,{value:T,done:!1}}}it=s}return{value:void 0,done:!0}}};return Xt[globalThis.Symbol.iterator]=function(){return this},Xt}function Ot(t,e){for(;e!==0n;){const o=BigInt(t)%BigInt(e);t=e,e=o}return t}function Yt(t){if(typeof t!="bigint")throw new TypeError;return t<0n?-t:t}function xt(t,e){if(typeof e!="number"||(e|0)!==e)throw new TypeError;let o=0,n=t.length-1;for(;o<n;){const l=Math.ceil((o+n)/2);(t[l]|0)>(e|0)?n=l-1:o=l}return(t[o]|0)===(e|0)?o:-1}function ne(t,e,o){const n=new Array(t.length+1).fill(0);for(let i=0;i<e.length;i+=1){const s=e[i].v;for(let c=0;c<s.length;c+=1)n[s[c]]+=1}let l=1n;for(let i=0;i<n.length;i+=1){if(n[i]%2!==0)throw new RangeError;if(i!==0){const s=t[i-1],c=n[i]/2;c>0&&(c<=2?l=l*BigInt(Math.pow(s,c))%o:l=l*Vt(BigInt(s),BigInt(c),o)%o)}}return l}function et(t){if(typeof t!="bigint")throw new TypeError;for(let e=1n;;e+=1n){const o=e*t,n=Math.min(Math.floor(navigator.hardwareConcurrency===12?2**23.5:2**23.75),(1<<25)-1),l=Math.max(Math.min(Math.floor(Math.sqrt(Lt(o)/(Number(t)>2**160?8:6))),n),1024),i=Jt(l).filter(y=>At(o,y));for(let y=0;y<i.length;y+=1)if(Number(t%BigInt(i[y]))===0)return BigInt(i[y]);const s=Dt(i,o),c=tt.sparseSolve(1+i.length);c.next();let m=null;const E=Date.now();let I=0,_=E;for(;(m=s.next().value)!=null;)if(m.Y.length===1&&m.Y[0]===0){const y=BigInt(Ot(Yt(m.X),t));if(y!==1n&&y!==t)return y}else{const y=function(){throw new TypeError(t)},h=m.Y.map(p=>p===-1?0:1+xt(i,p)||y()),$=c.next([h,{c:m,v:h}]).value;{I+=1;const p=+Date.now();(p-_>5e3||$!=null)&&(console.debug("congruences found: ",I,"/",i.length,"expected time: ",Math.round((p-E)/I*i.length),"large prime congruences: ",et.lpCounter,"polynomials used: ",et.polynomialsCounter),_=p)}if($!=null){let p=1n;for(let S=0;S<$.length;S+=1)p=p*$[S].c.X%t;let v=ne(i,$,t);const x=BigInt(Ot(Yt(p+v),t));if(x!==1n&&x!==t)return x}}}}et.testables={congruencesUsingQuadraticSieve:Dt,squareRootModuloOddPrime:mt,isQuadraticResidueModuloPrime:At,solve:tt,QuadraticPolynomial:lt,thresholdApproximationInterval:qt};function oe(t){return BigInt(t.toString(16).length*4)}function le(t,e,o){let n=1n;for(;e!==0n;)BigInt.asUintN(1,e)===1n&&(e-=1n,n=n*t%o),e>>=1n,t=t*t%o;return n}function re(t){const e=[];for(;t!==0n;){const o=Number(BigInt.asUintN(51,t));e.push(o),t>>=51n}return e}function ie(t,e){const o=t.length-1;let n=t[o];const l=e,i=(1+2**-52)/l;if(n-=Math.floor(n*i)*l,o>0){const s=0x8000000000000-Math.floor(0x8000000000000*i)*l;let c=o;do c-=1,n=n*s+t[c],n-=Math.floor(n*i)*l;while(c!==0)}return n}function se(t,e){var o=[];for(let n=t;n<=e;n+=1)o.push(n);return o}function ce(t){if(typeof t!="bigint")throw new RangeError;if(t<2n)throw new RangeError;const e=Number(t%30n);if(e%2===0)return t===2n;if(e%3===0)return t===3n;if(e%5===0)return t===5n;const o=[0,4,6,10,12,16,22,24,24],n=re(t);for(let _=7,y=Math.min(1024,Math.floor(Math.sqrt(Number(t))));_<=y;_+=30)for(let h=0;h<o.length;h+=1){const $=_+o[h];if(ie(n,$)===0)return!1}if(Number(t)<1024*1024)return!0;let l=0,i=t-1n;for(;i%2n===0n;)i/=2n,l+=1;const s=[10,20,24,31,40,41,48,48,61,61,61,78,81],c=[2,3,5,7,11,13,17,17,19,19,19,23,29];let m=0;const E=Math.ceil(Math.log2(Number(t)));for(;E>s[m]&&m<s.length;)m+=1;let I=null;if(m<s.length)I=c.slice(0,m+1);else{const _=Number(oe(t))*Math.log(2);I=se(2,Math.floor(1/Math.log(2)*_*Math.log(_)))}for(const _ of I){let y=le(BigInt(_),i,t);if(y!==1n){for(let h=l-1;h>0&&y!==t-1n;h-=1)y=y*y%t;if(y!==t-1n)return!1}}return!0}function*ue(t){for(;t!==1n;){const e=BigInt(ce(t)?t:et(t));yield e,t/=e}}onmessage=({data:{number:t,algorithm:e}})=>{switch(e){case"trial division":yt(t,$t);break;case"trial div v2":yt(t,jt);break;case"quadratic seive":yt(t,ue);break;default:yt(t,$t)}};const yt=(t,e)=>{try{const o=performance.now();for(const l of e(t))postMessage({res:l});const n=performance.now();postMessage({executionTime:n-o})}catch{console.error(`${typeof e(t)} was returned instead of array or bigint generator`)}}})();
